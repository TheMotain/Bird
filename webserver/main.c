#include <stdio.h>
#include <string.h>
#include "socket.h"
#include <unistd.h>       
#include <sys/socket.h>
#include <sys/types.h>
#include <stdlib.h>

int main()
{
  int socket_client;
  int socket_serveur;
  socket_serveur = creer_serveur(8000);
  socket_client = accept(socket_serveur, NULL, NULL);
  if(socket_client == -1)
    {
      perror("accept");
      return 0;
    }
  
  const char message1[] ="\n\n         ,--\"\"\"\",--.__,---[],-------.\n       ,\"   __,'            \\         \\--\"\"\"\"\"\"==;-\n     ,\" _,-\"  \"/---.___     \\       ___\\   ,-'',\"\n    /,-'      / ;. ,.--'-.__\\  _,-\"\" ,| `,'   /\n   /``\"\"\"\"-._/,-|:\\       []\\,' ```-/:;-. `. /\n             `  ;:::      ||       /:,;  `-.\\\n                =.,'__,---||-.____',.=\n                =(:\\_     ||__    ):)=\n               ,\"::::`----||::`--':::\"._\n             ,':::::::::::||::::::::::::'.\n    .__     ;:::.-.:::::__||___:::::.-.:::\\     __,\n       \"\"\"-;:::( O )::::>_|| _<::::( O )::::-\"\"\"\n   =======;:::::`-`:::::::||':::::::`-`:::::\\=======\n    ,--\"\";:::_____________||______________::::\"\"----.          , ,\n         ; ::`._(    |    |||     |   )_,'::::\\_,,,,,,,,,,____/,'_,\n       ,;    :::`--._|____[]|_____|_.-'::::::::::::::::::::::::);_\n      ;/ /      :::::::::,||,:::::::::::::::::::::::::::::::::::/\n     /; ``''''----------/,'/,__,,,,,____:::::::::::::::::::::,\"\n     ;/                :);/|_;| ,--.. . ```-.:::::::::::::_,\"\n    /;                :::):__,'//\"\"\\\\. ,--.. \\:::,:::::_,\"\n   ;/              :::::/ . . . . . . //\"\"\\\\. \\::\":__,\"\n   ;/          :::::::,' . . . . . . . . . . .:`::\\\n   ';      :::::::__,'. ,--.. . .,--. . . . . .:`::`\n   ';   __,..--'''-. . //\"\"\\\\. .//\"\"\\\\ . ,--.. :`:::`\n   ;    /  \\\\ .//\"\"\\\\ . . . . . . . . . //\"\"\\\\. :`::`\n   ;   /       . . . . . . . . . . . . . . . . .:`::`\n   ;   (          . . . . . . . . . . . . . . . ;:::`\n   ,:  ;,            . . . . . . . . . . . . . ;':::`\n   ,:  ;,             . . . . . . . . . . . . .;`:::\n   ,:   ;,             . . . . . . . . . . . . ;`::;`\n    ,:  ;             . . . . . . . . . . . . ;':::;`\n     :   ;             . . . . . . . . . . . ,':::;\n      :   '.          . . . . . . . .. . . .,':::;`\n       :    `.       . . . . . . . . . . . ;::::;`\n        '.    `-.   . . . . . . . . . . ,-'::::;\n          `:_    ``--..___________..--'':::::;'`\n             `._::,.:,.:,:_ctr_:,:,.::,.:_;'`\n________________`\"\\/\"\\/\\/'\"\"\"\"`\\/\"\\/\"\"\\/\"____________________________";
  const char message2[] ="\n\n             db         db\n            dpqb       dp8b\n            8b qb_____dp_88\n            88/ .        `p\n            q'.            \\\n           .'.  .-.    ,-.  `--.\n           |.  / 0 \\  / 0 \\ |   \\\n           |.  `.__   ___.' | \\\\/\n           |.       \"       | (\n            \\.    `-'-'    ,' |\n           _/`------------'. .|\n          /.  \\\\::(::[];)||.. \\\n         /.  ' \\.`:;;;;'''/`. .|\n        |.   |/ `;--._.__/  |..|\n        |.  _/_,'''',,`.    `:.'\n        |.     ` / ,  ',`.   |/     \"Yotsuya no Neko\"\n         \\.   -'/\\/     ',\\  |\\         gst38min\n          /\\__-' /\\ /     ,. |.\\       1995.08.31\n         /. .|  '  /-.    ,: |..\\\n        :.  .|    /| | ,  ,||. ..:\n        |.  .`     | '//` ,:|.  .|\n        |..  .\\      //\\/ ,|.  ..|\n         \\.   .\\     <./  ,'. ../\n          \\_ ,..`.__    _,..,._/\n            `\\|||/  `--'\\|||/'\n\n\n";
  int flag = 1;
  sleep(1);
  while(1)
    {
      if(flag == 1)
	write(socket_client, message1, sizeof(message1));
      else
	write(socket_client, message2, sizeof(message2));
      flag = flag * (-1);
      sleep(2);
    }
  return 0;
}


